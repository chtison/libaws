AWSTemplateFormatVersion: 2010-09-09

Resources:
    UserPool:
        Type: Custom::COGNITO-UserPool
        Properties:
            ServiceToken: {{ .ServiceToken_CognitoUserPool }}
            Properties:
                PoolName: MyPool
                Policies:
                    PasswordPolicy:
                        MinimumLength: 10
                        RequireLowercase: false
                        RequireNumbers: false
                        RequireSymbols: false
                        RequireUppercase: false
                AutoVerifiedAttributes: [email]
                AliasAttributes: [email]
                MfaConfiguration: 'OFF'
                UserPoolTags:
                    TagName: TagValue
                AdminCreateUserConfig:
                    AllowAdminCreateUserOnly: false
                    UnusedAccountValidityDays: 7
                Schema:
                    - Name: email
                      AttributeDataType: String
                      DeveloperOnlyAttribute: false
                      Mutable: true
                      Required: true
                      StringAttributeConstraints:
                          MinLength: 5
                          MaxLength: 2048

    UserPoolClient:
        Type: Custom::COGNITO-UserPoolClient
        DependsOn: UserPool
        Properties:
            ServiceToken: {{ .ServiceToken_CognitoUserPoolClient }}
            Properties:
                UserPoolId: !Ref UserPool
                ClientName: MyClient
                GenerateSecret: true
                RefreshTokenValidity: 7
                ReadAttributes:
                    - email
                    - email_verified

Outputs:
    UserPoolClientId:
        Value: !Ref UserPoolClient
    UserPoolClientSecret:
        Value: !GetAtt UserPoolClient.ClientSecret
